<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <title>Test CardField</title>
  <script src="/test/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="/test/jquery.caret.1.02.js" type="text/javascript" charset="utf-8"></script>
  <script src="/src/formatted_text_field.coffee" type="text/javascript" charset="utf-8"></script>
  <script src="/src/expiry_date_formatter.coffee" type="text/javascript" charset="utf-8"></script>
  <script src="/src/default_card_formatter.coffee" type="text/javascript" charset="utf-8"></script>

  <style type="text/css" media="screen">
    input[type=text] {
      width: 230px;
      height: 30px;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <input type="text" id="no-selection-test" placeholder="no selection" />
  <input type="text" id="month-year-test" placeholder="mm/yy" />
  <input type="text" id="credit-card-test" placeholder="1234 5678 8901 2345" />

  <script type="text/javascript" charset="utf-8">
  jQuery(function($) {
    var $noSelectionInput = $('#no-selection-test');
    var noSelectionField = new FormattedTextField($noSelectionInput);

    noSelectionField.formatter = {
      format: function(value){ return value; },
      parse: function(value){ return value; },

      isChangeValid: function(change) {
        var caret = change.proposed.caret;
        if (caret.start !== caret.end) {
          if (change.field.selectionAnchor === caret.end)
            caret.end = caret.start
          else
            caret.start = caret.end;
        }

        return true;
      }
    };

    var $monthYearInput = $('#month-year-test');
    var monthYearField = new FormattedTextField($monthYearInput);
    monthYearField.formatter = new ExpiryDateFormatter();

    var $creditCardInput = $('#credit-card-test');
    var creditCardField = new FormattedTextField($creditCardInput);
    creditCardField.formatter = new DefaultCardFormatter();
  });
  </script>
</body>
</html>
